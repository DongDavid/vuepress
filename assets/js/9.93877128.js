(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{59:function(e,r,t){"use strict";t.r(r);var a=t(0),n=Object(a.a)({},function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker","aria-hidden":"true"}},[e._v("#")]),e._v(" docker")]),e._v(" "),t("h2",{attrs:{id:"相关链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#相关链接","aria-hidden":"true"}},[e._v("#")]),e._v(" 相关链接")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://docs.docker.com/docker-for-mac/install/#install-and-run-docker-for-mac",target:"_blank",rel:"noopener noreferrer"}},[e._v("安装教程"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://docs.docker.com/docker-for-mac/#explore-the-application",target:"_blank",rel:"noopener noreferrer"}},[e._v("上手教程"),t("OutboundLink")],1)])]),e._v(" "),t("h2",{attrs:{id:"备注"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#备注","aria-hidden":"true"}},[e._v("#")]),e._v(" 备注")]),e._v(" "),t("ul",[t("li",[e._v("macOS 下所有下载的镜像都保存在"),t("code",[e._v("/Users/daviddong/Library/Containers/com.docker.docker/Data/")]),e._v("目录下")])]),e._v(" "),t("h2",{attrs:{id:"mac下安装docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mac下安装docker","aria-hidden":"true"}},[e._v("#")]),e._v(" mac下安装docker")]),e._v(" "),t("ul",[t("li",[e._v("从"),t("a",{attrs:{href:"https://store.docker.com/editions/community/docker-ce-desktop-mac",target:"_blank",rel:"noopener noreferrer"}},[e._v("官网"),t("OutboundLink")],1),e._v("下载安装包")]),e._v(" "),t("li",[e._v("用Terminal安装 "),t("code",[e._v("brew cask install docker")])])]),e._v(" "),t("h2",{attrs:{id:"注册docker账号"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注册docker账号","aria-hidden":"true"}},[e._v("#")]),e._v(" 注册docker账号")]),e._v(" "),t("p",[e._v("可以在官网的"),t("a",{attrs:{href:"https://hub.docker.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("注册页面"),t("OutboundLink")],1),e._v("注册账号,只需要邮箱。"),t("br"),e._v("\n但是注册的时候因为需要人机验证才可以点击注册按钮,而人机验证引用的js文件被墙了,所以需要解决一下网络问题。")]),e._v(" "),t("h2",{attrs:{id:"安装完成后检查"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装完成后检查","aria-hidden":"true"}},[e._v("#")]),e._v(" 安装完成后检查")]),e._v(" "),t("h3",{attrs:{id:"查看版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看版本","aria-hidden":"true"}},[e._v("#")]),e._v(" 查看版本")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ docker --version\nDocker version 18.03.1-ce, build 9ee9f40\n\n$ docker-compose --version\ndocker-compose version 1.21.1, build 5a3f1a3\n\ndocker-machine --version\ndocker-machine version 0.14.0, build 89b8332\n\n")])])]),t("h3",{attrs:{id:"判断是否支持实验特性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#判断是否支持实验特性","aria-hidden":"true"}},[e._v("#")]),e._v(" 判断是否支持实验特性")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ docker version -f '{{.Server.Experimental}}'\ntrue\n")])])]),t("table",[t("thead",[t("tr",[t("th",[e._v("docker命令")]),e._v(" "),t("th",[e._v("说明")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("docker inspect")]),e._v(" "),t("td",[e._v("获取所有变量")])]),e._v(" "),t("tr",[t("td",[e._v("docker port")]),e._v(" "),t("td",[e._v("查看映射端口")])]),e._v(" "),t("tr",[t("td",[e._v("docker run")]),e._v(" "),t("td",[e._v("启动docker")])]),e._v(" "),t("tr",[t("td",[e._v("docker ps")]),e._v(" "),t("td",[e._v("查看容器")])]),e._v(" "),t("tr",[t("td",[e._v("docker logs")]),e._v(" "),t("td",[e._v("查看容器信息")])]),e._v(" "),t("tr",[t("td",[e._v("docker stop")]),e._v(" "),t("td",[e._v("停止容器")])]),e._v(" "),t("tr",[t("td",[e._v("docker rm")]),e._v(" "),t("td",[e._v("删除容器")])]),e._v(" "),t("tr",[t("td",[e._v("docker-compose")]),e._v(" "),t("td",[e._v("根据配置文件启动容器 docker-compose -f /home/gary/dnmp/docker-compose.yml up -d")])]),e._v(" "),t("tr",[t("td",[e._v("docker system df")]),e._v(" "),t("td",[e._v("查看容器占用的硬盘空间")])]),e._v(" "),t("tr",[t("td",[e._v("docker system events")]),e._v(" "),t("td",[e._v("实时查看docker事件0.0")])]),e._v(" "),t("tr",[t("td",[e._v("docker system info")]),e._v(" "),t("td",[e._v("显示系统全局信息")])]),e._v(" "),t("tr",[t("td",[e._v("docker system prune")]),e._v(" "),t("td",[e._v("删除不使用的数据")])]),e._v(" "),t("tr",[t("td",[e._v("docker volume")]),e._v(" "),t("td",[e._v("列出所有数据卷-挂载目录")])]),e._v(" "),t("tr",[t("td",[e._v("docker volume ls -qf dangling=true")]),e._v(" "),t("td",[e._v("列出所有不使用的数据卷")])]),e._v(" "),t("tr",[t("td",[e._v("docker volume rm xxx")]),e._v(" "),t("td",[e._v("删除数据卷")])]),e._v(" "),t("tr",[t("td",[e._v("docker volume rm $(docker volume ls -qf dangling=true)")]),e._v(" "),t("td",[e._v("删除所有不使用的数据卷")])]),e._v(" "),t("tr",[t("td",[e._v("docker volume prune")]),e._v(" "),t("td",[e._v("删除所有不使用的数据卷 效果同上")])])])]),e._v(" "),t("h3",{attrs:{id:"查看docker信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看docker信息","aria-hidden":"true"}},[e._v("#")]),e._v(" 查看docker信息")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ docker info\nContainers: 0\n Running: 0\n Paused: 0\n Stopped: 0\nImages: 0\nServer Version: 18.03.1-ce\nStorage Driver: overlay2\n Backing Filesystem: extfs\n Supports d_type: true\n Native Overlay Diff: true\nLogging Driver: json-file\nCgroup Driver: cgroupfs\nPlugins:\n Volume: local\n Network: bridge host ipvlan macvlan null overlay\n Log: awslogs fluentd gcplogs gelf journald json-file logentries splunk syslog\nSwarm: inactive\nRuntimes: runc\nDefault Runtime: runc\nInit Binary: docker-init\ncontainerd version: 773c489c9c1b21a6d78b5c538cd395416ec50f88\nrunc version: 4fc53a81fb7c994640722ac585fa9ca548971871\ninit version: 949e6fa\nSecurity Options:\n seccomp\n  Profile: default\nKernel Version: 4.9.87-linuxkit-aufs\nOperating System: Docker for Mac\nOSType: linux\nArchitecture: x86_64\nCPUs: 2\nTotal Memory: 1.952GiB\nName: linuxkit-025000000001\nID: U4FI:W2OR:IQFG:XOPV:FZNT:SIAF:XY23:3CMM:RV22:KQSE:5KE6:55XC\nDocker Root Dir: /var/lib/docker\nDebug Mode (client): false\nDebug Mode (server): true\n File Descriptors: 21\n Goroutines: 39\n System Time: 2018-06-09T15:05:19.546403Z\n EventsListeners: 2\nHTTP Proxy: docker.for.mac.http.internal:3128\nHTTPS Proxy: docker.for.mac.http.internal:3129\nRegistry: https://index.docker.io/v1/\nLabels:\nExperimental: true\nInsecure Registries:\n 127.0.0.0/8\nLive Restore Enabled: false\n")])])]),t("h2",{attrs:{id:"镜像加速"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#镜像加速","aria-hidden":"true"}},[e._v("#")]),e._v(" 镜像加速")]),e._v(" "),t("p",[e._v("鉴于国内网络问题，后续拉取 Docker 镜像十分缓慢，我们可以需要配置加速器来解决，我使用的是网易的镜像地址：http://hub-mirror.c.163.com。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("https://registry.docker-cn.com\nhttp://hub-mirror.c.163.com\nhttps://docker.mirrors.ustc.edu.cn\n")])])]),t("p",[e._v("在任务栏点击 Docker for mac 应用图标 -> Perferences... -> Daemon -> Registry mirrors。在列表中填写加速器地址即可。修改完成之后，点击 Apply & Restart 按钮，Docker 就会重启并应用配置的镜像地址了。")]),e._v(" "),t("h2",{attrs:{id:"启动docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动docker","aria-hidden":"true"}},[e._v("#")]),e._v(" 启动docker")]),e._v(" "),t("ul",[t("li",[e._v("直接在Dashboard上点击docker图标启动")]),e._v(" "),t("li",[e._v("在Terminal执行")])]),e._v(" "),t("h2",{attrs:{id:"执行hello-world"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行hello-world","aria-hidden":"true"}},[e._v("#")]),e._v(" 执行hello world")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ docker run hello-world\nUnable to find image 'hello-world:latest' locally\nlatest: Pulling from library/hello-world\n9bb5a5d4561a: Pull complete \nDigest: sha256:f5233545e43561214ca4891fd1157e1c3c563316ed8e237750d59bde73361e77\nStatus: Downloaded newer image for hello-world:latest\n\nHello from Docker!\nThis message shows that your installation appears to be working correctly.\n\nTo generate this message, Docker took the following steps:\n 1. The Docker client contacted the Docker daemon.\n 2. The Docker daemon pulled the \"hello-world\" image from the Docker Hub.\n    (amd64)\n 3. The Docker daemon created a new container from that image which runs the\n    executable that produces the output you are currently reading.\n 4. The Docker daemon streamed that output to the Docker client, which sent it\n    to your terminal.\n\nTo try something more ambitious, you can run an Ubuntu container with:\n $ docker run -it ubuntu bash\n\nShare images, automate workflows, and more with a free Docker ID:\n https://hub.docker.com/\n\nFor more examples and ideas, visit:\n https://docs.docker.com/engine/userguide/\n")])])]),t("h2",{attrs:{id:"启动webserver服务器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动webserver服务器","aria-hidden":"true"}},[e._v("#")]),e._v(" 启动webserver服务器")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('$ docker run -d -p 80:80 --name webserver nginx\nUnable to find image \'nginx:latest\' locally\nlatest: Pulling from library/nginx\nf2aa67a397c4: Pull complete \n1cd0975d4f45: Pull complete \n72fd2d3be09a: Pull complete \nDigest: sha256:3e2ffcf0edca2a4e9b24ca442d227baea7b7f0e33ad654ef1eb806fbd9bedcf0\nStatus: Downloaded newer image for nginx:latest\n2395d101183c5932ad76fb32deaf080c55c6414e97d252bf6754bbdf831f6e7a\n\n# 查看运行中的docker容器列表\n$ docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES\n2395d101183c        nginx               "nginx -g \'daemon of…"   4 minutes ago       Up 4 minutes        0.0.0.0:80->80/tcp   webserver\n\n# 查看运行中的docker容器列表\n$ docker container ls\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES\n2395d101183c        nginx               "nginx -g \'daemon of…"   5 minutes ago       Up 5 minutes        0.0.0.0:80->80/tcp   webserver\n\n# 停止docker webserver\n$ docker container stop webserver\n\n# 查看所有的docker容器\n$ docker container ls -a\n$ docker container ls -a\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                      PORTS               NAMES\n2395d101183c        nginx               "nginx -g \'daemon of…"   7 minutes ago       Exited (0) 14 seconds ago                       webserver\n153ea48ff3c6        hello-world         "/hello"                 9 minutes ago       Exited (0) 9 minutes ago                        optimistic_mcnulty\n\n# 移除docker容器\n$ docker container rm webserver\n\n# 查看本地docker镜像\n$ docker image ls\n\n# 删除本地docker镜像\n$ docker image rm nginx\n')])])]),t("h2",{attrs:{id:"下载docker镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载docker镜像","aria-hidden":"true"}},[e._v("#")]),e._v(" 下载docker镜像")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker pull mysql\ndocker pull nginx\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo docker run --name=mysql -it -p 3306:3306 -e MYSQL_ROOT_PASSWORD=emc123123 -d mysql\n")])])]),t("h2",{attrs:{id:"建立lnmp-docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#建立lnmp-docker","aria-hidden":"true"}},[e._v("#")]),e._v(" 建立LNMP Docker")]),e._v(" "),t("blockquote",[t("p",[e._v("建立一个基于nginx、mysql、php的Docker环境"),t("br"),e._v(" "),t("a",{attrs:{href:"https://blog.csdn.net/xy752068432/article/details/75975065/",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考链接1"),t("OutboundLink")],1),t("br"),e._v(" "),t("a",{attrs:{href:"https://www.awaimai.com/2120.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考链接2"),t("OutboundLink")],1)])]),e._v(" "),t("h3",{attrs:{id:"首先下载docker镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#首先下载docker镜像","aria-hidden":"true"}},[e._v("#")]),e._v(" 首先下载Docker镜像")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker pull mysql:5.7\ndocker pull php:7.0-fpm\ndocker pull ngixn:1.10.3\n")])])]),t("h3",{attrs:{id:"关联各应用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关联各应用","aria-hidden":"true"}},[e._v("#")]),e._v(" 关联各应用")]),e._v(" "),t("p",[e._v("如果要关联Docker，使不同的Docker之间的服务可以互相调用,那么可以在执行"),t("code",[e._v("docker run")]),e._v("的时候使用"),t("code",[e._v("--link")]),e._v(" 参数")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -d -v /var/nginx/www/html:/var/www/html -p 9000:9000 --link xy_mysql:mysql --name xy_phpfpm php:7.0-fpm \n")])])]),t("h3",{attrs:{id:"限制容器使用内存"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#限制容器使用内存","aria-hidden":"true"}},[e._v("#")]),e._v(" 限制容器使用内存")]),e._v(" "),t("p",[t("code",[e._v("--memory-swap")]),e._v("这个参数必须和"),t("code",[e._v("-m/--memory")]),e._v("共同使用，表示内存和swap一共可用多少，如果两个参数的值相等的话，说明不可以使用swap")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -m 300m --memory-swap -1\n# 容器最多使用300m内存，但是可以使用的swap无限制\n\ndocker run -m 300m --memory-swap 1g\n# 容器最多使用300m内存，最多使用1g-300m=700m。swap\n")])])]),t("h3",{attrs:{id:"启动mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动mysql","aria-hidden":"true"}},[e._v("#")]),e._v(" 启动mysql")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -d -p 3307:3306 -e MYSQL_ROOT_PASSWORD=root --name xy_mysql mysql:5.6\n启动\n")])])]),t("table",[t("thead",[t("tr",[t("th",[e._v("命令")]),e._v(" "),t("th",[e._v("说明")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("docker")]),e._v(" "),t("td",[e._v("默认的命令")])]),e._v(" "),t("tr",[t("td",[e._v("run")]),e._v(" "),t("td",[e._v("启动镜像")])]),e._v(" "),t("tr",[t("td",[e._v("-d")]),e._v(" "),t("td",[e._v("后台运行")])]),e._v(" "),t("tr",[t("td",[e._v("-p")]),e._v(" "),t("td",[t("code",[e._v("-p 3307:3306")]),e._v(" 添加主机到容器的端口映射将本地的3307端口映射到容器的3306端口"),t("br"),t("code",[e._v("-p 127.0.0.1:3308:3306")]),e._v("也可以将指定IP的端口映射到容器的特定端口 "),t("br"),t("code",[e._v("-p 127.0.0.1::3306")]),e._v("随机分配一个本机端口映射到容器指定端口 "),t("br"),t("code",[e._v("127.0.0.1:5000:5000/udp")]),e._v("指定udp端口")])]),e._v(" "),t("tr",[t("td",[e._v("-e")]),e._v(" "),t("td",[e._v("设置环境变量 为mysql设置root密码")])]),e._v(" "),t("tr",[t("td",[e._v("--name")]),e._v(" "),t("td",[e._v("为容器命名，不可重复、随便起")])]),e._v(" "),t("tr",[t("td",[e._v("-m")]),e._v(" "),t("td",[e._v("设置容器可用最大内存")])]),e._v(" "),t("tr",[t("td",[e._v("--link=[]")]),e._v(" "),t("td",[e._v("链接到另一个容器")])]),e._v(" "),t("tr",[t("td",[e._v("-expose=[]")]),e._v(" "),t("td",[e._v("开放一个或一组端口")])]),e._v(" "),t("tr",[t("td",[e._v("-v")]),e._v(" "),t("td",[e._v("目录映射 "),t("code",[e._v("-v /docker目录:/本机目录")])])])])]),e._v(" "),t("p",[e._v("链接到docker内执行相关命令")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker exec -ti xy_mysql /bin/bash\n")])])]),t("p",[e._v("-t 在容器里生产一个伪终端"),t("br"),e._v("\n-i 对容器内的标准输入 (STDIN) 进行交互")]),e._v(" "),t("p",[e._v("进入mysql容器后，创建一个远程访问的账号")]),e._v(" "),t("h3",{attrs:{id:"启动php-fpm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动php-fpm","aria-hidden":"true"}},[e._v("#")]),e._v(" 启动php-fpm")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("# 其实不需要link也可以，因为可以通过ip加端口访问到\ndocker run -d -v /var/nginx/www/html:/var/www/html -p 9000:9000 --link xy_mysql:mysql --name xy_phpfpm php:7.0-fpm \n\n")])])]),t("p",[e._v("在docker中为php安装mysql的pdo扩展")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker-php-ext-install pdo_mysql\n")])])]),t("h3",{attrs:{id:"启动nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动nginx","aria-hidden":"true"}},[e._v("#")]),e._v(" 启动nginx")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -d -p 80:80 --name xy_nginx -v /var/nginx/www/html:/var/www/html --link xy_phpfpm:phpfpm --name xy_nginx nginx:1.10.3\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("进入容器修改nginx的配置文件 \ndocker exec -ti xy_nginx /bin/bash\n\nnginx重启\ndocker exec xy_nginx nginx -s reload\n")])])]),t("h2",{attrs:{id:"实际操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实际操作","aria-hidden":"true"}},[e._v("#")]),e._v(" 实际操作")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ docker run -d -p 80:80 -v /Users/daviddong/workSpace/docker/nginx:/nginx --name webserver nginx\n成功后会输出container的id\n\n# 进入名称为webserver的container ，可以通过命令行执行命令\n$ docker exec -ti webserver /bin/bash\nroot@9dc7ebf7de33:/# \n容器中默认是没有vi的。需要安装vi\n不过要先执行\napt update\napt-get update\ncp \n")])])])])},[],!1,null,null,null);r.default=n.exports}}]);